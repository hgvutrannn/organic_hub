{% extends 'core/base.html' %}

{% block title %}Quản lý sản phẩm - {{ store.store_name }}{% endblock %}

{% block content %}
<h1>Quản lý sản phẩm - {{ store.store_name }}</h1>

<!-- Navigation -->
<p>
    <a href="{% url 'store_dashboard' store.store_id %}">← Dashboard</a>
</p>

<!-- Add Product Button -->
<p>
    <a href="{% url 'add_product' store.store_id %}">+ Thêm sản phẩm mới</a>
</p>

<!-- Products List -->
<h2>Danh sách sản phẩm</h2>
{% if products %}
    <table border="1" cellpadding="10" cellspacing="0">
        <thead>
            <tr>
                <th>Tên sản phẩm</th>
                <th>Giá</th>
                <th>Danh mục</th>
                <th>Trạng thái</th>
                <th>Lượt xem</th>
                <th>Thao tác</th>
            </tr>
        </thead>
        <tbody>
            {% for product in products %}
            <tr>
                <td>
                    <strong>{{ product.name }}</strong>
                    {% if product.description %}
                        <br><small>{{ product.description|truncatechars:50 }}</small>
                    {% endif %}
                </td>
                <td>{{ product.price|floatformat:0 }} VNĐ</td>
                <td>{{ product.category.name|default:"-" }}</td>
                <td>
                    {% if product.is_active %}
                        <span style="color: green;">Đang bán</span>
                    {% else %}
                        <span style="color: red;">Ngừng bán</span>
                    {% endif %}
                </td>
                <td>{{ product.view_count }}</td>
                <td>
                    <a href="{% url 'edit_product' store.store_id product.product_id %}">Sửa</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <!-- Pagination -->
    {% if products.has_other_pages %}
        <div class="pagination">
            {% if products.has_previous %}
                <a href="?page=1">&laquo; Đầu</a>
                <a href="?page={{ products.previous_page_number }}">Trước</a>
            {% endif %}
            
            <span>Trang {{ products.number }} / {{ products.paginator.num_pages }}</span>
            
            {% if products.has_next %}
                <a href="?page={{ products.next_page_number }}">Tiếp</a>
                <a href="?page={{ products.paginator.num_pages }}">Cuối &raquo;</a>
            {% endif %}
        </div>
    {% endif %}
{% else %}
    <p>Chưa có sản phẩm nào. <a href="{% url 'add_product' store.store_id %}">Thêm sản phẩm đầu tiên</a></p>
{% endif %}
{% endblock %}
